<?xml version="1.0" encoding="iso-8859-1" ?>

<project name="jas" default="usage" basedir="." >

  <property name="src"      value="." />
  <property name="build"    value="." />
  <property name="doc"      value="doc" />
  <property name="test"     value="test" />

  <property name="libs"     value="/home/kredel/java/lib" />
  <property name="log4j"    value="${libs}/log4j.jar" />
  <property name="junit"    value="${libs}/junit.jar" />
  <property name="jomp"     value="${libs}/jomp1.0b.jar" />
  <property name="tnj"      value="${libs}/tnj.jar" />

  <property name="cp"       value="${log4j}:${junit}:${tnj}:." />
  <property name="version"  value="0.1" />

<target name="vorher" >
  <!-- set properties DSTAMP, TSTAMP -->
  <tstamp />
  <mkdir dir="edu/jas"  />
  <mkdir dir="${test}"  />
</target>

<target name="usage" >
  <echo message="ant &lt;name&gt; cl='cmd'"  />
  <echoproperties />
</target>

<target name="compile" depends="vorher,depend" >
  <javac srcdir="${src}" destdir="${build}" 
         classpath="${cp}" />
</target>

<target name="doc" >
  <javadoc sourcepath="${src}" destdir="${doc}" 
           classpath="${cp}" 
           private="true" >
     <fileset dir="." includes="**/*.java"  />
  </javadoc>
</target>

<target name="depend" depends="vorher" >
  <depend srcDir="${src}" destDir="${build}" 
          dump="true" closure="true" >
  </depend>
</target>

<target name="jdepend" depends="vorher" >
  <!-- does not work: jars missing  -->
  <jdepend outputfile="jdepend.report" > 
     <sourcespath>
        <pathelement location="${src}"/>
    </sourcespath>
  </jdepend>
</target>

<target name="time" depends="vorher" >
  <java  classname="edu.jas.poly.PolynomialTimings" 
         classpath="${cp}" 
         fork="yes" />
</target>

<target name="TestOld" depends="vorher" >
  <java  classname="edu.jas.SemaphoreTest" 
         classpath="${cp}" 
         fork="yes" />
  <java  classname="edu.jas.arith.BigRationalTest" 
         classpath="${cp}" 
         fork="yes" />
  <java  classname="edu.jas.arith.BigIntegerTest" 
         classpath="${cp}" 
         fork="yes" />
  <java  classname="edu.jas.poly.ExpVectorTest" 
         classpath="${cp}" 
         fork="yes" />
  <java  classname="edu.jas.poly.PolynomialTest" 
         classpath="${cp}" 
         fork="yes" />
  <java  classname="edu.jas.poly.RatPolynomialTest" 
         classpath="${cp}" 
         fork="yes" />
  <java  classname="edu.jas.poly.IntPolynomialTest" 
         classpath="${cp}" 
         fork="yes" />
  <java  classname="edu.jas.poly.RatGBaseTest" 
         classpath="${cp}" 
         fork="yes" />
</target>

<target name="testsingle" depends="vorher" >
  <junit printsummary="yes" 
         fork="yes" 
         showoutput="yes"
         haltonfailure="no" >
     <classpath path="${cp}" />
     <test name="edu.jas.arith.BigRationalTest" 
           outfile="brt.lst" />
  </junit>
</target>

<target name="test" depends="vorher" >
  <!-- works with apache ant download -->
  <!-- does not work with suse ant, optional for junit missing -->
  <!-- ok in 2004 09 -->
  <junit printsummary="yes" 
         fork="yes" 
         showoutput="yes"
         haltonfailure="yes" >
     <classpath path="${cp}" />
     <formatter type="plain" /> <!-- plain, xml, brief -->
     <batchtest todir="${test}" >
        <fileset dir="${src}">
          <include name="edu/**/*Test.class"/>
        </fileset>
     </batchtest>
  </junit>
</target>

<target name="jar" depends="vorher" >
  <jar jarfile="../jas-${DSTAMP}.jar"  >
     <fileset dir="." includes="**/*.java"  />
     <fileset dir="." includes="jas-log.html"  />
     <fileset dir="." includes="build.xml Makefile log4j.properties"  />
     <fileset dir="edu/jas" />
  </jar>
</target>

<target name="clean" >
  <delete verbose="true" >
    <fileset dir="${src}" defaultexcludes="no" includes="**/*~"  />
  </delete>
</target>

<target name="distclean" depends="clean" >
  <delete verbose="true" >
    <fileset dir="${src}" includes="**/*.class"  />
  </delete>
</target>

</project>
